### [Pipeline run code and environment:]

*              Command:  `/pine/scr/b/p/bpk/atac/pepatac/pipelines/pepatac.py --single-or-paired paired --prealignments rCRSd human_repeats --genome hg19 --sample-name test1 --input examples/data/test1_r1.fastq.gz --input2 examples/data/test1_r2.fastq.gz --genome-size hs -O /pine/scr/b/p/bpk/atac/pepatac/test_run`
*         Compute host:  c0828.ll.unc.edu
*          Working dir:  /pine/scr/b/p/bpk/atac/pepatac
*            Outfolder:  /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/
*  Pipeline started at:   (06-19 15:25:49) elapsed: 1.0 _TIME_

### [Version log:]

*       Python version:  2.7.12
*          Pypiper dir:  `/nas/longleaf/home/bpk/.local/lib/python2.7/site-packages/pypiper`
*      Pypiper version:  0.11.3
*         Pipeline dir:  `/pine/scr/b/p/bpk/atac/pepatac/pipelines`
*     Pipeline version:  0.8.6
*        Pipeline hash:  a0e4347b199c91bbfd7d994b0705da2ca8d51015
*      Pipeline branch:  * master
*        Pipeline date:  2019-03-26 13:11:27 -0400

### [Arguments passed to pipeline:]

*             `input2`:  `['examples/data/test1_r2.fastq.gz']`
*         `paired_end`:  `True`
*               `keep`:  `False`
*      `prealignments`:  `['rCRSd', 'human_repeats']`
*          `new_start`:  `False`
*            `recover`:  `False`
*     `frip_ref_peaks`:  `None`
*           `TSS_name`:  `None`
*       `deduplicator`:  `samblaster`
*        `sample_name`:  `test1`
*               `lite`:  `False`
*              `input`:  `['examples/data/test1_r1.fastq.gz']`
*        `genome_size`:  `hs`
*        `config_file`:  `pepatac.yaml`
*                `mem`:  `4000`
*       `force_follow`:  `False`
*          `blacklist`:  `None`
*              `cores`:  `1`
*          `anno_name`:  `None`
*            `trimmer`:  `skewer`
*        `peak_caller`:  `macs2`
*      `output_parent`:  `/pine/scr/b/p/bpk/atac/pepatac/test_run`
*   `single_or_paired`:  `paired`
*              `dirty`:  `False`
*    `genome_assembly`:  `hg19`
*            `no_fifo`:  `False`

----------------------------------------


Changed status from initializing to running.

Loading config file: /pine/scr/b/p/bpk/atac/pepatac/pipelines/pepatac.yaml

Local input file: examples/data/test1_r1.fastq.gz
Local input file: examples/data/test1_r2.fastq.gz

> `File_mb`	1.2043	PEPATAC	_RES_

> `Read_type`	paired	PEPATAC	_RES_

> `Genome`	hg19	PEPATAC	_RES_

### Merge/link and fastq conversion:  (06-19 15:25:49) elapsed: 0.0 _TIME_

Number of input file sets: 2
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R1.fastq.gz`


> `ln -sf /pine/scr/b/p/bpk/atac/pepatac/examples/data/test1_r1.fastq.gz /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R1.fastq.gz` (97188)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.0GB.
  PID: 97188;	Command: ln;	Return code: 0;	Memory used: 0.0GB
Local input file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R1.fastq.gz'
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R2.fastq.gz`


> `ln -sf /pine/scr/b/p/bpk/atac/pepatac/examples/data/test1_r2.fastq.gz /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R2.fastq.gz` (97192)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.0GB.
  PID: 97192;	Command: ln;	Return code: 0;	Memory used: 0.0GB
Local input file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R2.fastq.gz'
Found .fastq.gz file
Found .fastq.gz file
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.fastq`,`/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.fastq`


> `gzip -f -d -c /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R1.fastq.gz > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.fastq` (97194)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.0GB.
  PID: 97194;	Command: gzip;	Return code: 0;	Memory used: 0.0GB

> `gzip -f -d -c /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R2.fastq.gz > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.fastq` (97199)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.001GB.
  PID: 97199;	Command: gzip;	Return code: 0;	Memory used: 0.001GB
Follow:

> `Raw_reads`	25000	PEPATAC	_RES_

> `Fastq_reads`	25000	PEPATAC	_RES_
['/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R1.fastq.gz', '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/raw/test1_R2.fastq.gz']

### Adapter trimming:  (06-19 15:25:50) elapsed: 1.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq`


> `skewer -f sanger -t 1 -m pe -x /pine/scr/b/p/bpk/atac/pepatac/tools/NexteraPE-PE.fa --quiet -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.fastq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.fastq` (97219)

<pre>
.--. .-.
: .--': :.-.
`. `. : `'.' .--. .-..-..-. .--. .--.
_`, :: . `.' '_.': `; `; :' '_.': ..'
`.__.':_;:_;`.__.'`.__.__.'`.__.':_;
skewer v0.2.2 [April 4, 2016]
Parameters used:
-- 3' end adapter sequences in file (-x):	/pine/scr/b/p/bpk/atac/pepatac/tools/NexteraPE-PE.fa
A:	[0;33mAGATGTGTATAAGAGACAG
[0mB:	[0;33mAGATGTGTATAAGAGACAG
[0mC:	[0;33mTCGTCGGCAGCGTCAGATGTGTATAAGAGACAG
[0mD:	[0;33mCTGTCTCTTATACACATCTGACGCTGCCGACGA
[0mE:	[0;33mGTCTCGTGGGCTCGGAGATGTGTATAAGAGACAG
[0mF:	[0;33mCTGTCTCTTATACACATCTCCGAGCCCACGAGA
[0m-- maximum error ratio allowed (-r):	0.100
-- maximum indel error ratio allowed (-d):	0.030
-- minimum read length allowed after trimming (-l):	18
-- file format (-f):		Sanger/Illumina 1.8+ FASTQ 
Wed Jun 19 15:25:50 2019[0;32m >> started[0m

Wed Jun 19 15:25:51 2019[0;32m >> done[0m (1.355s)
12500 read pairs processed; of these:
    0 ( 0.00%) short read pairs filtered out after trimming by size control
    0 ( 0.00%) empty read pairs filtered out after trimming by size control
12500 (100.00%) read pairs available; of these:
 2848 (22.78%) trimmed read pairs available after processing
 9652 (77.22%) untrimmed read pairs available after processing
log has been saved to "/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1-trimmed.log".
</pre>
Command completed. Elapsed time: 0:00:02. Running peak memory: 0.001GB.
  PID: 97219;	Command: skewer;	Return code: 0;	Memory used: 0.0GB

> `mv /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1-trimmed-pair1.fastq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq` (97253)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.001GB.
  PID: 97253;	Command: mv;	Return code: 0;	Memory used: 0.0GB

> `mv /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1-trimmed-pair2.fastq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.trim.fastq` (97256)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.001GB.
  PID: 97256;	Command: mv;	Return code: 0;	Memory used: 0.0GB
Follow:
Evaluating read trimming

> `Trimmed_reads`	25000	PEPATAC	_RES_

> `Trim_loss_rate`	0.0	PEPATAC	_RES_
Targetless command, running...


> `fastqc --noextract --outdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastqc /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq` (97262)

<pre>
Started analysis of test1_R1.trim.fastq
Approx 5% complete for test1_R1.trim.fastq
Approx 15% complete for test1_R1.trim.fastq
Approx 20% complete for test1_R1.trim.fastq
Approx 30% complete for test1_R1.trim.fastq
Approx 40% complete for test1_R1.trim.fastq
Approx 45% complete for test1_R1.trim.fastq
Approx 55% complete for test1_R1.trim.fastq
Approx 60% complete for test1_R1.trim.fastq
Approx 70% complete for test1_R1.trim.fastq
Approx 80% complete for test1_R1.trim.fastq
Approx 85% complete for test1_R1.trim.fastq
Approx 95% complete for test1_R1.trim.fastq
Analysis complete for test1_R1.trim.fastq
</pre>
Command completed. Elapsed time: 0:00:07. Running peak memory: 0.001GB.
  PID: 97262;	Command: fastqc;	Return code: 0;	Memory used: 0.0GB
> `FastQC report r1`	fastqc/test1_R1.trim_fastqc.html	FastQC report r1	None	PEPATAC	_OBJ_
Targetless command, running...


> `fastqc --noextract --outdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastqc /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.trim.fastq` (97397)

<pre>
Started analysis of test1_R2.trim.fastq
Approx 5% complete for test1_R2.trim.fastq
Approx 15% complete for test1_R2.trim.fastq
Approx 20% complete for test1_R2.trim.fastq
Approx 30% complete for test1_R2.trim.fastq
Approx 40% complete for test1_R2.trim.fastq
Approx 45% complete for test1_R2.trim.fastq
Approx 55% complete for test1_R2.trim.fastq
Approx 60% complete for test1_R2.trim.fastq
Approx 70% complete for test1_R2.trim.fastq
Approx 80% complete for test1_R2.trim.fastq
Approx 85% complete for test1_R2.trim.fastq
Approx 95% complete for test1_R2.trim.fastq
Analysis complete for test1_R2.trim.fastq
</pre>
Command completed. Elapsed time: 0:00:07. Running peak memory: 0.001GB.
  PID: 97397;	Command: fastqc;	Return code: 0;	Memory used: 0.0GB
> `FastQC report r2`	fastqc/test1_R2.trim_fastqc.html	FastQC report r2	None	PEPATAC	_OBJ_

### Prealignments (06-19 15:26:05) elapsed: 15.0 _TIME_

Prealignment assemblies: ['rCRSd', 'human_repeats']

### Map to rCRSd (06-19 15:26:05) elapsed: 0.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/rCRSd_bt2`


> `mkfifo /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/rCRSd_bt2` (97539)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.001GB.
  PID: 97539;	Command: mkfifo;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_bt_aln_summary.log`,`/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq`


> `perl /pine/scr/b/p/bpk/atac/pepatac/tools/filter_paired_fq.pl /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/rCRSd_bt2 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.trim.fastq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R1.fq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq` (97542)

<pre>
</pre>
Not waiting for subprocesses: [97542]
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_bt_aln_summary.log`,`/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq`


> `(bowtie2 -p 1 -k 1 -D 20 -R 3 -N 1 -L 20 -i S,1,0.50 -x /pine/scr/b/p/bpk/atac/pepatac/rCRSd/indexed_bowtie2/rCRSd --rg-id test1 -U /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq --un /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/rCRSd_bt2 > /dev/null) 2>/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_bt_aln_summary.log` (97544)

<pre>
</pre>
Command completed. Elapsed time: 0:00:01. Running peak memory: 0.022GB.
  PID: 97544;	Command: bowtie2;	Return code: 0;	Memory used: 0.022GB

> `grep 'aligned exactly 1 time' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_bt_aln_summary.log | awk '{print $1}'`

1766 reads skipped
0 reads lost

> `Aligned_reads_rCRSd`	3532.0	PEPATAC	_RES_

> `Alignment_rate_rCRSd`	14.13	PEPATAC	_RES_

### Map to human_repeats (06-19 15:26:06) elapsed: 1.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/human_repeats_bt2`


> `mkfifo /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/human_repeats_bt2` (97575)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 0.022GB.
  PID: 97575;	Command: mkfifo;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_bt_aln_summary.log`,`/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq`


> `perl /pine/scr/b/p/bpk/atac/pepatac/tools/filter_paired_fq.pl /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/human_repeats_bt2 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R1.fq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R1.fq /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq` (97577)

<pre>
</pre>
Not waiting for subprocesses: [97577]
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_bt_aln_summary.log`,`/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq`


> `(bowtie2 -p 1 -k 1 -D 20 -R 3 -N 1 -L 20 -i S,1,0.50 -x /pine/scr/b/p/bpk/atac/pepatac/human_repeats/indexed_bowtie2/human_repeats --rg-id test1 -U /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R1.fq --un /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/human_repeats_bt2 > /dev/null) 2>/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_bt_aln_summary.log` (97579)

<pre>
</pre>
Command completed. Elapsed time: 0:00:01. Running peak memory: 0.023GB.
  PID: 97579;	Command: bowtie2;	Return code: 0;	Memory used: 0.023GB

> `grep 'aligned exactly 1 time' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_bt_aln_summary.log | awk '{print $1}'`


> `Aligned_reads_human_repeats`	1598.0	PEPATAC	_RES_
799 reads skipped
0 reads lost

> `Alignment_rate_human_repeats`	6.39	PEPATAC	_RES_

### Map to genome (06-19 15:26:08) elapsed: 1.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam`


> `bowtie2 -p 1  --very-sensitive -X 2000 --rg-id test1 -x /pine/scr/b/p/bpk/atac/pepatac/hg19/indexed_bowtie2/hg19 -1 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R1.fq -2 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq | samtools view -bS - -@ 1  | samtools sort - -@ 1 -T /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpzZtyhL -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam` (97615,97616,97617)

<pre>
9935 reads; of these:
  9935 (100.00%) were paired; of these:
    528 (5.31%) aligned concordantly 0 times
    8064 (81.17%) aligned concordantly exactly 1 time
    1343 (13.52%) aligned concordantly >1 times
    ----
    528 pairs aligned concordantly 0 times; of these:
      16 (3.03%) aligned discordantly 1 time
    ----
    512 pairs aligned 0 times concordantly or discordantly; of these:
      1024 mates make up the pairs; of these:
        783 (76.46%) aligned 0 times
        169 (16.50%) aligned exactly 1 time
        72 (7.03%) aligned >1 times
96.06% overall alignment rate
</pre>
Command completed. Elapsed time: 0:00:22. Running peak memory: 3.412GB.
  PID: 97615;	Command: bowtie2;	Return code: 0;	Memory used: 3.412GB
  PID: 97617;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 97616;	Command: samtools;	Return code: 0;	Memory used: 0.0GB

> `samtools view -b -q 10 -@ 1 -U /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_fail_qc.bam -f 2 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam` (98021)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98021;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
Follow:

> `Mapped_reads`	19087	PEPATAC	_RES_

> `QC_filtered_reads`	1465.0	PEPATAC	_RES_

> `Aligned_reads`	17622	PEPATAC	_RES_

> `Alignment_rate`	70.49	PEPATAC	_RES_

> `Total_efficiency`	70.49	PEPATAC	_RES_
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R1.fq.gz`


> `gzip -f /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R1.fq` (98037)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98037;	Command: gzip;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq.gz`


> `gzip -f /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_rCRSd_unmap_R2.fq` (98048)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98048;	Command: gzip;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R1.fq.gz`


> `gzip -f /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R1.fq` (98059)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98059;	Command: gzip;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq.gz`


> `gzip -f /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/test1_human_repeats_unmap_R2.fq` (98060)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98060;	Command: gzip;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam.bai`


> `samtools index /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam` (98061)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98061;	Command: samtools;	Return code: 0;	Memory used: 0.0GB

> `samtools index /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam` (98062)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98062;	Command: samtools;	Return code: 0;	Memory used: 0.0GB

> `samtools idxstats /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam | grep -we 'chrM' -we 'chrMT' -we 'M' -we 'MT' -we 'rCRSd'| cut -f 3`


> `Mitochondrial_reads`	1.0	PEPATAC	_RES_
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_noMT.bam`


> `samtools idxstats /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam | cut -f 1 | grep -vwe 'chrM' -vwe 'chrMT' -vwe 'M' -vwe 'MT' -vwe 'rCRSd'| xargs samtools view -b -@ 1 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_noMT.bam` (98068,98069,98070,98071)

<pre>
</pre>
Command completed. Elapsed time: 0:00:01. Running peak memory: 3.412GB.
  PID: 98068;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 98070;	Command: grep;	Return code: 0;	Memory used: 0.0GB
  PID: 98069;	Command: cut;	Return code: 0;	Memory used: 0.0GB
  PID: 98071;	Command: xargs;	Return code: 0;	Memory used: 0.006GB

> `mv /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_noMT.bam /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam` (98083)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98083;	Command: mv;	Return code: 0;	Memory used: 0.0GB

> `samtools index /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam` (98087)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98087;	Command: samtools;	Return code: 0;	Memory used: 0.0GB

### Calculate NRF, PBC1, and PBC2 (06-19 15:26:33) elapsed: 26.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv`


> `/pine/scr/b/p/bpk/atac/pepatac/tools/bamQC.py -i /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam -c 1 -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv` (98091)

<pre>
Configured logger 'root' using pararead v0.6
Registering input file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam'
Temporary files will be stored in: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/tmp_test1_sort_JlpHxz'
Processing with 1 cores...
[Name: chr19_gl000208_random; Size: 92689]
[Name: chr13; Size: 115169878]
[Name: chr12; Size: 133851895]
[Name: chr11; Size: 135006516]
[Name: chr10; Size: 135534747]
[Name: chr17; Size: 81195210]
[Name: chr16; Size: 90354753]
[Name: chr15; Size: 102531392]
[Name: chr14; Size: 107349540]
[Name: chr19; Size: 59128983]
[Name: chr18; Size: 78077248]
[Name: chrUn_gl000234; Size: 40531]
[Name: chr6_cox_hap2; Size: 4795371]
[Name: chr17_gl000205_random; Size: 174588]
[Name: chr8; Size: 146364022]
[Name: chr7_gl000195_random; Size: 182896]
[Name: chr3; Size: 198022430]
[Name: chr1; Size: 249250621]
[Name: chrX; Size: 155270560]
[Name: chr9; Size: 141213431]
[Name: chrUn_gl000214; Size: 137718]
[Name: chrUn_gl000216; Size: 172294]
[Name: chr22; Size: 51304566]
[Name: chr20; Size: 63025520]
[Name: chr21; Size: 48129895]
[Name: chr7; Size: 159138663]
[Name: chr6; Size: 171115067]
[Name: chr5; Size: 180915260]
[Name: chr4; Size: 191154276]
[Name: chr2; Size: 243199373]
[Name: chr1_gl000192_random; Size: 547496]
[Name: chrUn_gl000224; Size: 179693]
[Name: chrUn_gl000225; Size: 211173]
[Name: chrUn_gl000220; Size: 161802]
Discarding 59 chunk(s) of reads: ['chr21_gl000210_random', 'chr6_apd_hap1', 'chr9_gl000198_random', 'chrUn_gl000239', 'chrUn_gl000238', 'chrUn_gl000233', 'chrUn_gl000232', 'chrUn_gl000231', 'chrUn_gl000230', 'chrUn_gl000237', 'chrUn_gl000236', 'chrUn_gl000235', 'chr6_qbl_hap6', 'chr11_gl000202_random', 'chr17_gl000206_random', 'chr4_gl000193_random', 'chrUn_gl000248', 'chrUn_gl000249', 'chrUn_gl000246', 'chrUn_gl000247', 'chrUn_gl000244', 'chrUn_gl000245', 'chrUn_gl000242', 'chrUn_gl000243', 'chrUn_gl000240', 'chrUn_gl000241', 'chr17_gl000204_random', 'chr17_ctg5_hap1', 'chr9_gl000199_random', 'chr9_gl000201_random', 'chr6_ssto_hap7', 'chr8_gl000197_random', 'chr6_dbb_hap3', 'chr1_gl000191_random', 'chr4_ctg9_hap1', 'chrUn_gl000229', 'chr17_gl000203_random', 'chr4_gl000194_random', 'chrY', 'chr9_gl000200_random', 'chrM', 'chr8_gl000196_random', 'chr6_mann_hap4', 'chrUn_gl000211', 'chrUn_gl000213', 'chrUn_gl000212', 'chrUn_gl000215', 'chrUn_gl000217', 'chrUn_gl000219', 'chrUn_gl000218', 'chr19_gl000209_random', 'chr6_mcf_hap5', 'chrUn_gl000228', 'chrUn_gl000226', 'chrUn_gl000227', 'chrUn_gl000221', 'chrUn_gl000222', 'chrUn_gl000223', 'chr18_gl000207_random']
Keeping 34 chunk(s) of reads: ['chr19_gl000208_random', 'chr13', 'chr12', 'chr11', 'chr10', 'chr17', 'chr16', 'chr15', 'chr14', 'chr19', 'chr18', 'chrUn_gl000234', 'chr6_cox_hap2', 'chr17_gl000205_random', 'chr8', 'chr7_gl000195_random', 'chr3', 'chr1', 'chrX', 'chr9', 'chrUn_gl000214', 'chrUn_gl000216', 'chr22', 'chr20', 'chr21', 'chr7', 'chr6', 'chr5', 'chr4', 'chr2', 'chr1_gl000192_random', 'chrUn_gl000224', 'chrUn_gl000225', 'chrUn_gl000220']
Reduce step (merge files)...
Merging 34 files into output file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv'
</pre>
Command completed. Elapsed time: 0:00:03. Running peak memory: 3.412GB.
  PID: 98091;	Command: /pine/scr/b/p/bpk/atac/pepatac/tools/bamQC.py;	Return code: 0;	Memory used: 0.0GB
Follow:

> `awk '{ for (i=1; i<=NF; ++i) { if ($i ~ "NRF") c=i } getline; print $c }' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv`


> `awk '{ for (i=1; i<=NF; ++i) { if ($i ~ "PBC1") c=i } getline; print $c }' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv`


> `awk '{ for (i=1; i<=NF; ++i) { if ($i ~ "PBC2") c=i } getline; print $c }' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_bamQC.tsv`


> `NRF`	1.0	PEPATAC	_RES_

> `PBC1`	1.0	PEPATAC	_RES_

> `PBC2`	8811.0	PEPATAC	_RES_
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_unmap.bam`


> `samtools view -b -@ 1 -f 12  /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_unmap.bam` (98152)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98152;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
Follow:

> `samtools view -c -f 4 -@ 1 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam`


> `Unmapped_reads`	783.0	PEPATAC	_RES_

### Remove dupes, build bigwig and bedgraph files (06-19 15:26:36) elapsed: 3.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam`


> `samtools sort -n -@ 1 -T /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpOkN2mV /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort.bam | samtools view -h - -@ 1 | samblaster -r 2> /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_dedup_metrics_log.txt | samtools view -b - -@ 1 | samtools sort - -@ 1 -T /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpOkN2mV -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam` (98159,98160,98161,98163,98166)

<pre>
</pre>
Command completed. Elapsed time: 0:00:02. Running peak memory: 3.412GB.
  PID: 98159;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 98161;	Command: samblaster;	Return code: 0;	Memory used: 0.002GB
  PID: 98166;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 98160;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 98163;	Command: samtools;	Return code: 0;	Memory used: 0.0GB

> `samtools index /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam` (98200)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 3.412GB.
  PID: 98200;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
Follow:

> `grep 'Removed' /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_dedup_metrics_log.txt | cut -f 3 -d ' '`


> `Duplicate_reads`	0	PEPATAC	_RES_

> `Dedup_aligned_reads`	17622.0	PEPATAC	_RES_

> `Dedup_alignment_rate`	70.49	PEPATAC	_RES_

> `Dedup_total_efficiency`	70.49	PEPATAC	_RES_

### Produce smoothed and nucleotide-resolution tracks (06-19 15:26:38) elapsed: 2.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp/flag_completed`


> `/pine/scr/b/p/bpk/atac/pepatac/tools/bamSitesToWig.py -i /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam -c /pine/scr/b/p/bpk/atac/pepatac/hg19/hg19.chromSizes -b /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_shift.bed -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_exact.bw -w /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_smooth.bw -m atac -p 1` (98208)

<pre>
Configured logger 'root' using pararead v0.6
Cutting parallel chroms in half to accommodate two tracks.
Registering input file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam'
Temporary files will be stored in: 'tmp_test1_sort_dedup_3cexQg'
Processing with 1 cores...
[Name: chr19_gl000208_random; Size: 92689]
[Name: chr13; Size: 115169878]
[Name: chr12; Size: 133851895]
[Name: chr11; Size: 135006516]
[Name: chr10; Size: 135534747]
[Name: chr17; Size: 81195210]
[Name: chr16; Size: 90354753]
[Name: chr15; Size: 102531392]
[Name: chr14; Size: 107349540]
[Name: chr19; Size: 59128983]
[Name: chr18; Size: 78077248]
[Name: chrUn_gl000234; Size: 40531]
[Name: chr6_cox_hap2; Size: 4795371]
[Name: chr17_gl000205_random; Size: 174588]
[Name: chr8; Size: 146364022]
[Name: chr7_gl000195_random; Size: 182896]
[Name: chr3; Size: 198022430]
[Name: chr1; Size: 249250621]
[Name: chrX; Size: 155270560]
[Name: chr9; Size: 141213431]
[Name: chrUn_gl000214; Size: 137718]
[Name: chrUn_gl000216; Size: 172294]
[Name: chr22; Size: 51304566]
[Name: chr20; Size: 63025520]
[Name: chr21; Size: 48129895]
[Name: chr7; Size: 159138663]
[Name: chr6; Size: 171115067]
[Name: chr5; Size: 180915260]
[Name: chr4; Size: 191154276]
[Name: chr2; Size: 243199373]
[Name: chr1_gl000192_random; Size: 547496]
[Name: chrUn_gl000224; Size: 179693]
[Name: chrUn_gl000225; Size: 211173]
[Name: chrUn_gl000220; Size: 161802]
Discarding 59 chunk(s) of reads: ['chr21_gl000210_random', 'chr6_apd_hap1', 'chr9_gl000198_random', 'chrUn_gl000239', 'chrUn_gl000238', 'chrUn_gl000233', 'chrUn_gl000232', 'chrUn_gl000231', 'chrUn_gl000230', 'chrUn_gl000237', 'chrUn_gl000236', 'chrUn_gl000235', 'chr6_qbl_hap6', 'chr11_gl000202_random', 'chr17_gl000206_random', 'chr4_gl000193_random', 'chrUn_gl000248', 'chrUn_gl000249', 'chrUn_gl000246', 'chrUn_gl000247', 'chrUn_gl000244', 'chrUn_gl000245', 'chrUn_gl000242', 'chrUn_gl000243', 'chrUn_gl000240', 'chrUn_gl000241', 'chr17_gl000204_random', 'chr17_ctg5_hap1', 'chr9_gl000199_random', 'chr9_gl000201_random', 'chr6_ssto_hap7', 'chr8_gl000197_random', 'chr6_dbb_hap3', 'chr1_gl000191_random', 'chr4_ctg9_hap1', 'chrUn_gl000229', 'chr17_gl000203_random', 'chr4_gl000194_random', 'chrY', 'chr9_gl000200_random', 'chrM', 'chr8_gl000196_random', 'chr6_mann_hap4', 'chrUn_gl000211', 'chrUn_gl000213', 'chrUn_gl000212', 'chrUn_gl000215', 'chrUn_gl000217', 'chrUn_gl000219', 'chrUn_gl000218', 'chr19_gl000209_random', 'chr6_mcf_hap5', 'chrUn_gl000228', 'chrUn_gl000226', 'chrUn_gl000227', 'chrUn_gl000221', 'chrUn_gl000222', 'chrUn_gl000223', 'chr18_gl000207_random']
Keeping 34 chunk(s) of reads: ['chr19_gl000208_random', 'chr13', 'chr12', 'chr11', 'chr10', 'chr17', 'chr16', 'chr15', 'chr14', 'chr19', 'chr18', 'chrUn_gl000234', 'chr6_cox_hap2', 'chr17_gl000205_random', 'chr8', 'chr7_gl000195_random', 'chr3', 'chr1', 'chrX', 'chr9', 'chrUn_gl000214', 'chrUn_gl000216', 'chr22', 'chr20', 'chr21', 'chr7', 'chr6', 'chr5', 'chr4', 'chr2', 'chr1_gl000192_random', 'chrUn_gl000224', 'chrUn_gl000225', 'chrUn_gl000220']
Reduce step (merge files)...
Merging 34 files into output file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_exact.bw'
Merging 34 files into output file: '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_smooth.bw'
</pre>
Command completed. Elapsed time: 0:51:33. Running peak memory: 4.245GB.
  PID: 98208;	Command: /pine/scr/b/p/bpk/atac/pepatac/tools/bamSitesToWig.py;	Return code: 0;	Memory used: 4.245GB

> `touch /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp/flag_completed` (79994)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 79994;	Command: touch;	Return code: 0;	Memory used: 0.0GB

### Calculate TSS enrichment (06-19 16:18:11) elapsed: 3093.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_TssEnrichment.txt`


> `/pine/scr/b/p/bpk/atac/pepatac/tools/pyTssEnrichment.py -a /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam -b /pine/scr/b/p/bpk/atac/pepatac/hg19/hg19_TSS.tsv -p ends -c 1 -e 2000 -u -v -s 4 -o /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_TssEnrichment.txt` (80000)

<pre>
</pre>
Command completed. Elapsed time: 0:00:04. Running peak memory: 4.245GB.
  PID: 80000;	Command: /pine/scr/b/p/bpk/atac/pepatac/tools/pyTssEnrichment.py;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_TssEnrichment.pdf`


> `Rscript /pine/scr/b/p/bpk/atac/pepatac/tools/PEPATAC_TSSenrichmentPlot.R /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_TssEnrichment.txt pdf` (80250)

<pre>

Generating TSS plot with /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_TssEnrichment.txt
Completed!

</pre>
Command completed. Elapsed time: 0:00:03. Running peak memory: 4.245GB.
  PID: 80250;	Command: Rscript;	Return code: 0;	Memory used: 0.0GB

> `TSS_Score`	8.30188679245	PEPATAC	_RES_
> `TSS enrichment`	QC_hg19/test1_TssEnrichment.pdf	TSS enrichment	QC_hg19/test1_TssEnrichment.png	PEPATAC	_OBJ_

### Plot fragment distribution (06-19 16:18:18) elapsed: 6.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLenDistribution.pdf`


> `perl /pine/scr/b/p/bpk/atac/pepatac/tools/fragment_length_dist.pl /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLen.txt` (80428)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80428;	Command: perl;	Return code: 0;	Memory used: 0.0GB

> `sort -n  /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLen.txt | uniq -c  > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragCount.txt` (80446,80448)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80446;	Command: sort;	Return code: 0;	Memory used: 0.0GB
  PID: 80448;	Command: uniq;	Return code: 0;	Memory used: 0.0GB

> `Rscript /pine/scr/b/p/bpk/atac/pepatac/tools/fragment_length_dist.R /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLen.txt /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragCount.txt /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLenDistribution.pdf /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_fragLenDistribution.txt` (80460)

<pre>
</pre>
Command completed. Elapsed time: 0:00:01. Running peak memory: 4.245GB.
  PID: 80460;	Command: Rscript;	Return code: 0;	Memory used: 0.0GB
> `Fragment distribution`	QC_hg19/test1_fragLenDistribution.pdf	Fragment distribution	QC_hg19/test1_fragLenDistribution.png	PEPATAC	_OBJ_

### Call peaks (06-19 16:18:19) elapsed: 1.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.narrowPeak`


> `macs2 callpeak -t /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_shift.bed --outdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19 -n test1 -g hs -f BED -q 0.01 --shift 0 --nomodel` (80507)

<pre>
INFO  @ Wed, 19 Jun 2019 16:18:19: 
# Command line: callpeak -t /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_shift.bed --outdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19 -n test1 -g hs -f BED -q 0.01 --shift 0 --nomodel
# ARGUMENTS LIST:
# name = test1
# format = BED
# ChIP-seq file = ['/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/test1_shift.bed']
# control file = None
# effective genome size = 2.70e+09
# band width = 300
# model fold = [5, 50]
# qvalue cutoff = 1.00e-02
# The maximum gap between significant sites is assigned as the read length/tag size.
# The minimum length of peaks is assigned as the predicted fragment length "d".
# Larger dataset will be scaled towards smaller dataset.
# Range for calculating regional lambda is: 10000 bps
# Broad region calling is off
# Paired-End mode is off
 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 read tag files... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 read treatment tags... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 tag size is determined as 50 bps 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 tag size = 50.0 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1  total tags in treatment: 17622 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 user defined the maximum tags... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 filter out redundant tags at the same location and the same strand by allowing at most 1 tag(s) 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1  tags after filtering in treatment: 17610 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1  Redundant rate of treatment: 0.00 
INFO  @ Wed, 19 Jun 2019 16:18:19: #1 finished! 
INFO  @ Wed, 19 Jun 2019 16:18:19: #2 Build Peak Model... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #2 Skipped... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #2 Use 200 as fragment length 
INFO  @ Wed, 19 Jun 2019 16:18:19: #3 Call peaks... 
INFO  @ Wed, 19 Jun 2019 16:18:19: #3 Pre-compute pvalue-qvalue table... 
INFO  @ Wed, 19 Jun 2019 16:18:20: #3 Call peaks for each chromosome... 
INFO  @ Wed, 19 Jun 2019 16:18:20: #4 Write output xls file... /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.xls 
INFO  @ Wed, 19 Jun 2019 16:18:20: #4 Write peak in narrowPeak format file... /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.narrowPeak 
INFO  @ Wed, 19 Jun 2019 16:18:20: #4 Write summits bed file... /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_summits.bed 
INFO  @ Wed, 19 Jun 2019 16:18:20: Done! 
</pre>
Command completed. Elapsed time: 0:00:01. Running peak memory: 4.245GB.
  PID: 80507;	Command: macs2;	Return code: 0;	Memory used: 0.0GB
Follow:

> `Peak_count`	0	PEPATAC	_RES_

### Calculate fraction of reads in peaks (FRiP) (06-19 16:18:20) elapsed: 1.0 _TIME_


> `samtools view -@ 4 -c -L /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.narrowPeak /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam`

('17622', u'0')

> `FRiP`	0.0	PEPATAC	_RES_

### # Produce bigBed formatted narrowPeak file (06-19 16:18:20) elapsed: 0.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bigBed`


> `Rscript /pine/scr/b/p/bpk/atac/pepatac/tools/narrowPeakToBigBed.R /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.narrowPeak /pine/scr/b/p/bpk/atac/pepatac/hg19/hg19.chromSizes bedToBigBed /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bigBed` (80577)

<pre>
Error: Install the "argparser" library before proceeding.
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80577;	Command: Rscript;	Return code: 0;	Memory used: 0.0GB

### Calculate peak coverage (06-19 16:18:20) elapsed: 0.0 _TIME_

Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_sort.bed`


> `cut -f 1-3 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.narrowPeak > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bed` (80615)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80615;	Command: cut;	Return code: 0;	Memory used: 0.0GB

> `samtools view -H /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam | grep 'SN:' | awk -F':' '{print $2,$3}' | awk -F' ' -v OFS='	' '{print $1,$3}' > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/chr_order.txt` (80620,80622,80624,80625)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80620;	Command: samtools;	Return code: 0;	Memory used: 0.0GB
  PID: 80624;	Command: awk;	Return code: 0;	Memory used: 0.0GB
  PID: 80622;	Command: grep;	Return code: 0;	Memory used: 0.0GB
  PID: 80625;	Command: awk;	Return code: 0;	Memory used: 0.0GB

> `bedtools sort -i /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bed -faidx /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/chr_order.txt > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_sort.bed` (80639)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80639;	Command: bedtools;	Return code: 0;	Memory used: 0.0GB
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_coverage.bed`


> `bedtools coverage -sorted -counts -a /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_sort.bed -b /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam -g /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/chr_order.txt > /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_coverage.bed` (80648)

<pre>
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80648;	Command: bedtools;	Return code: 0;	Memory used: 0.0GB

### Calculate read coverage (06-19 16:18:21) elapsed: 0.0 _TIME_

Skipping read annotation
This requires a hg19 annotation file.
Confirm this file is present in /pine/scr/b/p/bpk/atac/pepatac/anno or specify using `--anno-name`

### Plot FRiP/F (06-19 16:18:21) elapsed: 0.0 _TIME_


> `samtools view -@ 1 -q 10 -c -F4 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_sort_dedup.bam`

['Rscript', '/pine/scr/b/p/bpk/atac/pepatac/tools/PEPATAC_frip.R', 'test1', '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_coverage.bed', '17622', '/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_frip.pdf']
Target to produce: `/pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_frip.pdf`


> `Rscript /pine/scr/b/p/bpk/atac/pepatac/tools/PEPATAC_frip.R test1 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_coverage.bed 17622 /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/QC_hg19/test1_frip.pdf` (80661)

<pre>
Error: Install the "argparser" library before proceeding.
</pre>
Command completed. Elapsed time: 0:00:00. Running peak memory: 4.245GB.
  PID: 80661;	Command: Rscript;	Return code: 0;	Memory used: 0.0GB
> `Cumulative FRiP`	QC_hg19/test1_frip.pdf	Cumulative FRiP	QC_hg19/test1_frip.png	PEPATAC	_OBJ_

### Annotate peaks (06-19 16:18:21) elapsed: 0.0 _TIME_

Cannot annotate peaks without a hg19 annotation file
Confirm this file is present in /pine/scr/b/p/bpk/atac/pepatac/anno or specify using `--anno-name`

Changed status from running to completed.
Starting cleanup: 13 files; 3 conditional files for cleanup

Cleaning up flagged intermediate files. . .

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/tmpAa1zLE
`rmdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/tmpAa1zLE`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/rCRSd_bt2

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/tmpN44HQb
`rmdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/tmpN44HQb`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/prealignments/human_repeats_bt2

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpzZtyhL
`rmdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpzZtyhL`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam.bai
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam.bai`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/test1_temp.bam`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpOkN2mV
`rmdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19/tmpOkN2mV`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp/flag_completed
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp/flag_completed`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp
`rmdir /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/aligned_hg19_exact/temp`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bed
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks.bed`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/chr_order.txt
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/chr_order.txt`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_sort.bed
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/peak_calling_hg19/test1_peaks_sort.bed`

Cleaning up conditional list. . .

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1*.fastq
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.fastq`
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.fastq`
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R2.trim.fastq`
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1_R1.trim.fastq`

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/*.fq

Removing glob: /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/*.log
`rm /pine/scr/b/p/bpk/atac/pepatac/test_run/test1/fastq/test1-trimmed.log`

> `Time`	0:52:33	PEPATAC	_RES_

> `Success`	06-19-16:18:21	PEPATAC	_RES_

##### [Epilogue:]
*   Total elapsed time:  0:52:33
*     Peak memory used:  4.24 GB
* Pipeline completed at:  (06-19 16:18:21) elapsed: 0.0 _TIME_
